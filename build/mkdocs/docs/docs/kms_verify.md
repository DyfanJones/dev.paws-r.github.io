<table style="width: 100%;">
<tbody>
<tr class="odd">
<td>kms_verify</td>
<td style="text-align: right;">R Documentation</td>
</tr>
</tbody>
</table>

## Verifies a digital signature that was generated by the Sign operation

### Description

Verifies a digital signature that was generated by the `sign` operation.

Verification confirms that an authorized user signed the message with
the specified KMS key and signing algorithm, and the message hasn't
changed since it was signed. If the signature is verified, the value of
the `SignatureValid` field in the response is `True`. If the signature
verification fails, the `verify` operation fails with an
`KMSInvalidSignatureException` exception.

A digital signature is generated by using the private key in an
asymmetric KMS key. The signature is verified by using the public key in
the same asymmetric KMS key. For information about asymmetric KMS keys,
see [Asymmetric KMS
keys](https://docs.aws.amazon.com/kms/latest/developerguide/symmetric-asymmetric.html)
in the *Key Management Service Developer Guide*.

To use the `verify` operation, specify the same asymmetric KMS key,
message, and signing algorithm that were used to produce the signature.
The message type does not need to be the same as the one used for
signing, but it must indicate whether the value of the `Message`
parameter should be hashed as part of the verification process.

You can also verify the digital signature by using the public key of the
KMS key outside of KMS. Use the `get_public_key` operation to download
the public key in the asymmetric KMS key and then use the public key to
verify the signature outside of KMS. The advantage of using the `verify`
operation is that it is performed within KMS. As a result, it's easy to
call, the operation is performed within the FIPS boundary, it is logged
in CloudTrail, and you can use key policy and IAM policy to determine
who is authorized to use the KMS key to verify signatures.

To verify a signature outside of KMS with an SM2 public key (China
Regions only), you must specify the distinguishing ID. By default, KMS
uses `1234567812345678` as the distinguishing ID. For more information,
see [Offline verification with SM2 key
pairs](https://docs.aws.amazon.com/kms/latest/developerguide/asymmetric-key-specs.html#key-spec-sm-offline-verification).

The KMS key that you use for this operation must be in a compatible key
state. For details, see [Key states of KMS
keys](https://docs.aws.amazon.com/kms/latest/developerguide/key-state.html)
in the *Key Management Service Developer Guide*.

**Cross-account use**: Yes. To perform this operation with a KMS key in
a different Amazon Web Services account, specify the key ARN or alias
ARN in the value of the `KeyId` parameter.

**Required permissions**:
[kms:Verify](https://docs.aws.amazon.com/kms/latest/developerguide/kms-api-permissions-reference.html)
(key policy)

**Related operations**: `sign`

### Usage

    kms_verify(KeyId, Message, MessageType, Signature, SigningAlgorithm,
      GrantTokens)

### Arguments

<table>
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<tbody>
<tr class="odd">
<td><code id="kms_verify_:_KeyId">KeyId</code></td>
<td><p>[required] Identifies the asymmetric KMS key that will be used to
verify the signature. This must be the same KMS key that was used to
generate the signature. If you specify a different KMS key, the
signature verification fails.</p>
<p>To specify a KMS key, use its key ID, key ARN, alias name, or alias
ARN. When using an alias name, prefix it with <code>"alias/"</code>. To
specify a KMS key in a different Amazon Web Services account, you must
use the key ARN or alias ARN.</p>
<p>For example:</p>
<ul>
<li><p>Key ID: <code
style="white-space: pre;">⁠1234abcd-12ab-34cd-56ef-1234567890ab⁠</code></p></li>
<li><p>Key ARN: <code
style="white-space: pre;">⁠arn:aws:kms:us-east-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab⁠</code></p></li>
<li><p>Alias name: <code>alias/ExampleAlias</code></p></li>
<li><p>Alias ARN:
<code>arn:aws:kms:us-east-2:111122223333:alias/ExampleAlias</code></p></li>
</ul>
<p>To get the key ID and key ARN for a KMS key, use
<code>list_keys</code> or <code>describe_key</code>. To get the alias
name and alias ARN, use <code>list_aliases</code>.</p></td>
</tr>
<tr class="even">
<td><code id="kms_verify_:_Message">Message</code></td>
<td><p>[required] Specifies the message that was signed. You can submit
a raw message of up to 4096 bytes, or a hash digest of the message. If
you submit a digest, use the <code>MessageType</code> parameter with a
value of <code>DIGEST</code>.</p>
<p>If the message specified here is different from the message that was
signed, the signature verification fails. A message and its hash digest
are considered to be the same message.</p></td>
</tr>
<tr class="odd">
<td><code id="kms_verify_:_MessageType">MessageType</code></td>
<td><p>Tells KMS whether the value of the <code>Message</code> parameter
should be hashed as part of the signing algorithm. Use <code>RAW</code>
for unhashed messages; use <code>DIGEST</code> for message digests,
which are already hashed.</p>
<p>When the value of <code>MessageType</code> is <code>RAW</code>, KMS
uses the standard signing algorithm, which begins with a hash function.
When the value is <code>DIGEST</code>, KMS skips the hashing step in the
signing algorithm.</p>
<p>Use the <code>DIGEST</code> value only when the value of the
<code>Message</code> parameter is a message digest. If you use the
<code>DIGEST</code> value with an unhashed message, the security of the
verification operation can be compromised.</p>
<p>When the value of <code>MessageType</code>is <code>DIGEST</code>, the
length of the <code>Message</code> value must match the length of hashed
messages for the specified signing algorithm.</p>
<p>You can submit a message digest and omit the <code>MessageType</code>
or specify <code>RAW</code> so the digest is hashed again while signing.
However, if the signed message is hashed once while signing, but twice
while verifying, verification fails, even when the message hasn't
changed.</p>
<p>The hashing algorithm in that <code>verify</code> uses is based on
the <code>SigningAlgorithm</code> value.</p>
<ul>
<li><p>Signing algorithms that end in SHA_256 use the SHA_256 hashing
algorithm.</p></li>
<li><p>Signing algorithms that end in SHA_384 use the SHA_384 hashing
algorithm.</p></li>
<li><p>Signing algorithms that end in SHA_512 use the SHA_512 hashing
algorithm.</p></li>
<li><p>SM2DSA uses the SM3 hashing algorithm. For details, see <a
href="https://docs.aws.amazon.com/kms/latest/developerguide/asymmetric-key-specs.html#key-spec-sm-offline-verification">Offline
verification with SM2 key pairs</a>.</p></li>
</ul></td>
</tr>
<tr class="even">
<td><code id="kms_verify_:_Signature">Signature</code></td>
<td><p>[required] The signature that the <code>sign</code> operation
generated.</p></td>
</tr>
<tr class="odd">
<td><code
id="kms_verify_:_SigningAlgorithm">SigningAlgorithm</code></td>
<td><p>[required] The signing algorithm that was used to sign the
message. If you submit a different algorithm, the signature verification
fails.</p></td>
</tr>
<tr class="even">
<td><code id="kms_verify_:_GrantTokens">GrantTokens</code></td>
<td><p>A list of grant tokens.</p>
<p>Use a grant token when your permission to call this operation comes
from a new grant that has not yet achieved <em>eventual
consistency</em>. For more information, see <a
href="https://docs.aws.amazon.com/kms/latest/developerguide/grants.html#grant_token">Grant
token</a> and <a
href="https://docs.aws.amazon.com/kms/latest/developerguide/grant-manage.html#using-grant-token">Using
a grant token</a> in the <em>Key Management Service Developer
Guide</em>.</p></td>
</tr>
</tbody>
</table>

### Value

A list with the following syntax:

    list(
      KeyId = "string",
      SignatureValid = TRUE|FALSE,
      SigningAlgorithm = "RSASSA_PSS_SHA_256"|"RSASSA_PSS_SHA_384"|"RSASSA_PSS_SHA_512"|"RSASSA_PKCS1_V1_5_SHA_256"|"RSASSA_PKCS1_V1_5_SHA_384"|"RSASSA_PKCS1_V1_5_SHA_512"|"ECDSA_SHA_256"|"ECDSA_SHA_384"|"ECDSA_SHA_512"|"SM2DSA"
    )

### Request syntax

    svc$verify(
      KeyId = "string",
      Message = raw,
      MessageType = "RAW"|"DIGEST",
      Signature = raw,
      SigningAlgorithm = "RSASSA_PSS_SHA_256"|"RSASSA_PSS_SHA_384"|"RSASSA_PSS_SHA_512"|"RSASSA_PKCS1_V1_5_SHA_256"|"RSASSA_PKCS1_V1_5_SHA_384"|"RSASSA_PKCS1_V1_5_SHA_512"|"ECDSA_SHA_256"|"ECDSA_SHA_384"|"ECDSA_SHA_512"|"SM2DSA",
      GrantTokens = list(
        "string"
      )
    )

### Examples

    ## Not run: 
    # This operation uses the public key in an elliptic curve (ECC) asymmetric
    # key to verify a digital signature within AWS KMS.
    svc$verify(
      KeyId = "alias/ECC_signing_key",
      Message = "<message to be verified>",
      MessageType = "RAW",
      Signature = "<binary data>",
      SigningAlgorithm = "ECDSA_SHA_384"
    )

    # This operation uses the public key in an RSA asymmetric signing key pair
    # to verify the digital signature of a message digest. Hashing a message
    # into a digest before sending it to KMS lets you verify messages that
    # exceed the 4096-byte message size limit. To indicate that the value of
    # Message is a digest, use the MessageType parameter
    svc$verify(
      KeyId = "arn:aws:kms:us-east-2:111122223333:key/0987dcba-09fe-87dc-65ba-ab0987654321",
      Message = "<message digest to be verified>",
      MessageType = "DIGEST",
      Signature = "<binary data>",
      SigningAlgorithm = "RSASSA_PSS_SHA_512"
    )

    ## End(Not run)
