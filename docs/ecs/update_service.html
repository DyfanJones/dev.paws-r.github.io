<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Updating the task placement strategies and constraints on an Amazon ECS
service remains in preview and is a Beta Service as defined by and
subject to the Beta Service Participation Service Terms located at
https://aws — ecs_update_service • paws</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script href="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script href="../pkgdown.js"></script>




<meta property="og:title" content="Updating the task placement strategies and constraints on an Amazon ECS
service remains in preview and is a Beta Service as defined by and
subject to the Beta Service Participation Service Terms located at
https://aws — ecs_update_service" />
<meta property="og:description" content="Updating the task placement strategies and constraints on an Amazon ECS
service remains in preview and is a Beta Service as defined by and
subject to the Beta Service Participation Service Terms located at
https://aws.amazon.com/service-terms (\&quot;Beta Terms\&quot;). These Beta
Terms apply to your participation in this preview." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="..">paws</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
</li>
<li>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/paws-r/paws/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Updating the task placement strategies and constraints on an Amazon ECS
service remains in preview and is a Beta Service as defined by and
subject to the Beta Service Participation Service Terms located at
https://aws</h1>
    <small class="dont-index">Source: <a href='https://github.com/paws-r/paws/blob/master/R/ecs_operations.R'><code>R/ecs_operations.R</code></a></small>
    <div class="hidden name"><code>ecs_update_service.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Updating the task placement strategies and constraints on an Amazon ECS
service remains in preview and is a Beta Service as defined by and
subject to the Beta Service Participation Service Terms located at
<a href='https://aws.amazon.com/service-terms'>https://aws.amazon.com/service-terms</a> (\"Beta Terms\"). These Beta
Terms apply to your participation in this preview.</p>
    </div>

    <pre class="usage"><span class='fu'>ecs_update_service</span>(<span class='no'>cluster</span>, <span class='no'>service</span>, <span class='no'>desiredCount</span>, <span class='no'>taskDefinition</span>,
  <span class='no'>capacityProviderStrategy</span>, <span class='no'>deploymentConfiguration</span>, <span class='no'>networkConfiguration</span>,
  <span class='no'>placementConstraints</span>, <span class='no'>placementStrategy</span>, <span class='no'>platformVersion</span>,
  <span class='no'>forceNewDeployment</span>, <span class='no'>healthCheckGracePeriodSeconds</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>cluster</th>
      <td><p>The short name or full Amazon Resource Name (ARN) of the cluster that
your service is running on. If you do not specify a cluster, the default
cluster is assumed.</p></td>
    </tr>
    <tr>
      <th>service</th>
      <td><p>[required] The name of the service to update.</p></td>
    </tr>
    <tr>
      <th>desiredCount</th>
      <td><p>The number of instantiations of the task to place and keep running in
your service.</p></td>
    </tr>
    <tr>
      <th>taskDefinition</th>
      <td><p>The <code>family</code> and <code>revision</code> (<code>family:revision</code>) or full ARN of the task
definition to run in your service. If a <code>revision</code> is not specified, the
latest <code>ACTIVE</code> revision is used. If you modify the task definition with
<code>UpdateService</code>, Amazon ECS spawns a task with the new version of the
task definition and then stops an old task after the new version is
running.</p></td>
    </tr>
    <tr>
      <th>capacityProviderStrategy</th>
      <td><p>The capacity provider strategy to update the service to use.</p>
<p>If the service is using the default capacity provider strategy for the
cluster, the service can be updated to use one or more capacity
providers as opposed to the default capacity provider strategy. However,
when a service is using a capacity provider strategy that is not the
default capacity provider strategy, the service cannot be updated to use
the cluster\'s default capacity provider strategy.</p>
<p>A capacity provider strategy consists of one or more capacity providers
along with the <code>base</code> and <code>weight</code> to assign to them. A capacity
provider must be associated with the cluster to be used in a capacity
provider strategy. The PutClusterCapacityProviders API is used to
associate a capacity provider with a cluster. Only capacity providers
with an <code>ACTIVE</code> or <code>UPDATING</code> status can be used.</p>
<p>If specifying a capacity provider that uses an Auto Scaling group, the
capacity provider must already be created. New capacity providers can be
created with the CreateCapacityProvider API operation.</p>
<p>To use a AWS Fargate capacity provider, specify either the <code>FARGATE</code> or
<code>FARGATE_SPOT</code> capacity providers. The AWS Fargate capacity providers
are available to all accounts and only need to be associated with a
cluster to be used.</p>
<p>The PutClusterCapacityProviders API operation is used to update the list
of available capacity providers for a cluster after the cluster is
created.</p></td>
    </tr>
    <tr>
      <th>deploymentConfiguration</th>
      <td><p>Optional deployment parameters that control how many tasks run during
the deployment and the ordering of stopping and starting tasks.</p></td>
    </tr>
    <tr>
      <th>networkConfiguration</th>
      <td></td>
    </tr>
    <tr>
      <th>placementConstraints</th>
      <td><p>An array of task placement constraint objects to update the service to
use. If no value is specified, the existing placement constraints for
the service will remain unchanged. If this value is specified, it will
override any existing placement constraints defined for the service. To
remove all existing placement constraints, specify an empty array.</p>
<p>You can specify a maximum of 10 constraints per task (this limit
includes constraints in the task definition and those specified at
runtime).</p></td>
    </tr>
    <tr>
      <th>placementStrategy</th>
      <td><p>The task placement strategy objects to update the service to use. If no
value is specified, the existing placement strategy for the service will
remain unchanged. If this value is specified, it will override the
existing placement strategy defined for the service. To remove an
existing placement strategy, specify an empty object.</p>
<p>You can specify a maximum of five strategy rules per service.</p></td>
    </tr>
    <tr>
      <th>platformVersion</th>
      <td><p>The platform version on which your tasks in the service are running. A
platform version is only specified for tasks using the Fargate launch
type. If a platform version is not specified, the <code>LATEST</code> platform
version is used by default. For more information, see <a href='https://docs.aws.amazon.com/AmazonECS/latest/developerguide/platform_versions.html'>AWS Fargate Platform Versions</a>
in the <em>Amazon Elastic Container Service Developer Guide</em>.</p></td>
    </tr>
    <tr>
      <th>forceNewDeployment</th>
      <td><p>Whether to force a new deployment of the service. Deployments are not
forced by default. You can use this option to trigger a new deployment
with no service definition changes. For example, you can update a
service\'s tasks to use a newer Docker image with the same image/tag
combination (<code>my_image:latest</code>) or to roll Fargate tasks onto a newer
platform version.</p></td>
    </tr>
    <tr>
      <th>healthCheckGracePeriodSeconds</th>
      <td><p>The period of time, in seconds, that the Amazon ECS service scheduler
should ignore unhealthy Elastic Load Balancing target health checks
after a task has first started. This is only valid if your service is
configured to use a load balancer. If your service\'s tasks take a while
to start and respond to Elastic Load Balancing health checks, you can
specify a health check grace period of up to 2,147,483,647 seconds.
During that time, the Amazon ECS service scheduler ignores the Elastic
Load Balancing health check status. This grace period can prevent the
ECS service scheduler from marking tasks as unhealthy and stopping them
before they have time to come up.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Modifies the parameters of a service.</p>
<p>For services using the rolling update (<code>ECS</code>) deployment controller, the
desired count, deployment configuration, network configuration, task
placement constraints and strategies, or task definition used can be
updated.</p>
<p>For services using the blue/green (<code>CODE_DEPLOY</code>) deployment controller,
only the desired count, deployment configuration, task placement
constraints and strategies, and health check grace period can be updated
using this API. If the network configuration, platform version, or task
definition need to be updated, a new AWS CodeDeploy deployment should be
created. For more information, see
<a href='https://docs.aws.amazon.com/codedeploy/latest/APIReference/API_CreateDeployment.html'>CreateDeployment</a>
in the <em>AWS CodeDeploy API Reference</em>.</p>
<p>For services using an external deployment controller, you can update
only the desired count, task placement constraints and strategies, and
health check grace period using this API. If the launch type, load
balancer, network configuration, platform version, or task definition
need to be updated, you should create a new task set. For more
information, see CreateTaskSet.</p>
<p>You can add to or subtract from the number of instantiations of a task
definition in a service by specifying the cluster that the service is
running in and a new <code>desiredCount</code> parameter.</p>
<p>If you have updated the Docker image of your application, you can create
a new task definition with that image and deploy it to your service. The
service scheduler uses the minimum healthy percent and maximum percent
parameters (in the service\'s deployment configuration) to determine the
deployment strategy.</p>
<p>If your updated Docker image uses the same tag as what is in the
existing task definition for your service (for example,
<code>my_image:latest</code>), you do not need to create a new revision of your
task definition. You can update the service using the
<code>forceNewDeployment</code> option. The new tasks launched by the deployment
pull the current image/tag combination from your repository when they
start.</p>
<p>You can also update the deployment configuration of a service. When a
deployment is triggered by updating the task definition of a service,
the service scheduler uses the deployment configuration parameters,
<code>minimumHealthyPercent</code> and <code>maximumPercent</code>, to determine the
deployment strategy.</p><ul>
<li><p>If <code>minimumHealthyPercent</code> is below 100%, the scheduler can ignore
<code>desiredCount</code> temporarily during a deployment. For example, if
<code>desiredCount</code> is four tasks, a minimum of 50% allows the scheduler
to stop two existing tasks before starting two new tasks. Tasks for
services that do not use a load balancer are considered healthy if
they are in the <code>RUNNING</code> state. Tasks for services that use a load
balancer are considered healthy if they are in the <code>RUNNING</code> state
and the container instance they are hosted on is reported as healthy
by the load balancer.</p></li>
<li><p>The <code>maximumPercent</code> parameter represents an upper limit on the
number of running tasks during a deployment, which enables you to
define the deployment batch size. For example, if <code>desiredCount</code> is
four tasks, a maximum of 200% starts four new tasks before stopping
the four older tasks (provided that the cluster resources required
to do this are available).</p></li>
</ul>

<p>When UpdateService stops a task during a deployment, the equivalent of
<code>docker stop</code> is issued to the containers running in the task. This
results in a <code>SIGTERM</code> and a 30-second timeout, after which <code>SIGKILL</code> is
sent and the containers are forcibly stopped. If the container handles
the <code>SIGTERM</code> gracefully and exits within 30 seconds from receiving it,
no <code>SIGKILL</code> is sent.</p>
<p>When the service scheduler launches new tasks, it determines task
placement in your cluster with the following logic:</p><ul>
<li><p>Determine which of the container instances in your cluster can
support your service\'s task definition (for example, they have the
required CPU, memory, ports, and container instance attributes).</p></li>
<li><p>By default, the service scheduler attempts to balance tasks across
Availability Zones in this manner (although you can choose a
different placement strategy):</p><ul>
<li><p>Sort the valid container instances by the fewest number of
running tasks for this service in the same Availability Zone as
the instance. For example, if zone A has one running service
task and zones B and C each have zero, valid container instances
in either zone B or C are considered optimal for placement.</p></li>
<li><p>Place the new service task on a valid container instance in an
optimal Availability Zone (based on the previous steps),
favoring container instances with the fewest number of running
tasks for this service.</p></li>
</ul></li>
</ul>

<p>When the service scheduler stops running tasks, it attempts to maintain
balance across the Availability Zones in your cluster using the
following logic:</p><ul>
<li><p>Sort the container instances by the largest number of running tasks
for this service in the same Availability Zone as the instance. For
example, if zone A has one running service task and zones B and C
each have two, container instances in either zone B or C are
considered optimal for termination.</p></li>
<li><p>Stop the task on a container instance in an optimal Availability
Zone (based on the previous steps), favoring container instances
with the largest number of running tasks for this service.</p></li>
</ul>

    <h2 class="hasAnchor" id="request-syntax"><a class="anchor" href="#request-syntax"></a>Request syntax</h2>

    
<pre><span class='no'>svc</span>$<span class='fu'>update_service</span>(
  <span class='kw'>cluster</span> <span class='kw'>=</span> <span class='st'>"string"</span>,
  <span class='kw'>service</span> <span class='kw'>=</span> <span class='st'>"string"</span>,
  <span class='kw'>desiredCount</span> <span class='kw'>=</span> <span class='fl'>123</span>,
  <span class='kw'>taskDefinition</span> <span class='kw'>=</span> <span class='st'>"string"</span>,
  <span class='kw'>capacityProviderStrategy</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
    <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
      <span class='kw'>capacityProvider</span> <span class='kw'>=</span> <span class='st'>"string"</span>,
      <span class='kw'>weight</span> <span class='kw'>=</span> <span class='fl'>123</span>,
      <span class='kw'>base</span> <span class='kw'>=</span> <span class='fl'>123</span>
    )
  ),
  <span class='kw'>deploymentConfiguration</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
    <span class='kw'>maximumPercent</span> <span class='kw'>=</span> <span class='fl'>123</span>,
    <span class='kw'>minimumHealthyPercent</span> <span class='kw'>=</span> <span class='fl'>123</span>
  ),
  <span class='kw'>networkConfiguration</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
    <span class='kw'>awsvpcConfiguration</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
      <span class='kw'>subnets</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
        <span class='st'>"string"</span>
      ),
      <span class='kw'>securityGroups</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
        <span class='st'>"string"</span>
      ),
      <span class='kw'>assignPublicIp</span> <span class='kw'>=</span> <span class='st'>"ENABLED"</span><span class='kw'>|</span><span class='st'>"DISABLED"</span>
    )
  ),
  <span class='kw'>placementConstraints</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
    <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
      <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"distinctInstance"</span><span class='kw'>|</span><span class='st'>"memberOf"</span>,
      <span class='kw'>expression</span> <span class='kw'>=</span> <span class='st'>"string"</span>
    )
  ),
  <span class='kw'>placementStrategy</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
    <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
      <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"random"</span><span class='kw'>|</span><span class='st'>"spread"</span><span class='kw'>|</span><span class='st'>"binpack"</span>,
      <span class='kw'>field</span> <span class='kw'>=</span> <span class='st'>"string"</span>
    )
  ),
  <span class='kw'>platformVersion</span> <span class='kw'>=</span> <span class='st'>"string"</span>,
  <span class='kw'>forceNewDeployment</span> <span class='kw'>=</span> <span class='fl'>TRUE</span><span class='kw'>|</span><span class='fl'>FALSE</span>,
  <span class='kw'>healthCheckGracePeriodSeconds</span> <span class='kw'>=</span> <span class='fl'>123</span>
)</pre>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># This example updates the my-http-service service to use the</span>
<span class='co'># amazon-ecs-sample task definition.</span>
<span class='no'>svc</span>$<span class='fu'>update_service</span>(
  <span class='kw'>service</span> <span class='kw'>=</span> <span class='st'>"my-http-service"</span>,
  <span class='kw'>taskDefinition</span> <span class='kw'>=</span> <span class='st'>"amazon-ecs-sample"</span>
)

<span class='co'># This example updates the desired count of the my-http-service service to</span>
<span class='co'># 10.</span>
<span class='no'>svc</span>$<span class='fu'>update_service</span>(
  <span class='kw'>desiredCount</span> <span class='kw'>=</span> <span class='fl'>10L</span>,
  <span class='kw'>service</span> <span class='kw'>=</span> <span class='st'>"my-http-service"</span>
)
}</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Kretch, Adam Banker.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


