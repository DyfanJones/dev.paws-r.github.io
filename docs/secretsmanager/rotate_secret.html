<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Configures and starts the asynchronous process of rotating this secret — secretsmanager_rotate_secret • paws</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script href="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script href="../pkgdown.js"></script>




<meta property="og:title" content="Configures and starts the asynchronous process of rotating this secret — secretsmanager_rotate_secret" />
<meta property="og:description" content="Configures and starts the asynchronous process of rotating this secret.
If you include the configuration parameters, the operation sets those
values for the secret and then immediately starts a rotation. If you do
not include the configuration parameters, the operation starts a
rotation with the values already stored in the secret. After the
rotation completes, the protected service and its clients all use the
new version of the secret." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="..">paws</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
</li>
<li>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/paws-r/paws/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Configures and starts the asynchronous process of rotating this secret</h1>
    <small class="dont-index">Source: <a href='https://github.com/paws-r/paws/blob/master/R/secretsmanager_operations.R'><code>R/secretsmanager_operations.R</code></a></small>
    <div class="hidden name"><code>secretsmanager_rotate_secret.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Configures and starts the asynchronous process of rotating this secret.
If you include the configuration parameters, the operation sets those
values for the secret and then immediately starts a rotation. If you do
not include the configuration parameters, the operation starts a
rotation with the values already stored in the secret. After the
rotation completes, the protected service and its clients all use the
new version of the secret.</p>
    </div>

    <pre class="usage"><span class='fu'>secretsmanager_rotate_secret</span>(<span class='no'>SecretId</span>, <span class='no'>ClientRequestToken</span>,
  <span class='no'>RotationLambdaARN</span>, <span class='no'>RotationRules</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>SecretId</th>
      <td><p>[required] Specifies the secret that you want to rotate. You can specify either the
Amazon Resource Name (ARN) or the friendly name of the secret.</p>
<p>If you specify an ARN, we generally recommend that you specify a
complete ARN. You can specify a partial ARN too---for example, if you
don't include the final hyphen and six random characters that Secrets
Manager adds at the end of the ARN when you created the secret. A
partial ARN match can work as long as it uniquely matches only one
secret. However, if your secret has a name that ends in a hyphen
followed by six characters (before Secrets Manager adds the hyphen and
six characters to the ARN) and you try to use that as a partial ARN,
then those characters cause Secrets Manager to assume that you're
specifying a complete ARN. This confusion can cause unexpected results.
To avoid this situation, we recommend that you don't create secret names
ending with a hyphen followed by six characters.</p>
<p>If you specify an incomplete ARN without the random suffix, and instead
provide the \'friendly name\', you <em>must</em> not include the random suffix.
If you do include the random suffix added by Secrets Manager, you
receive either a <em>ResourceNotFoundException</em> or an
<em>AccessDeniedException</em> error, depending on your permissions.</p></td>
    </tr>
    <tr>
      <th>ClientRequestToken</th>
      <td><p>(Optional) Specifies a unique identifier for the new version of the
secret that helps ensure idempotency.</p>
<p>If you use the AWS CLI or one of the AWS SDK to call this operation,
then you can leave this parameter empty. The CLI or SDK generates a
random UUID for you and includes that in the request for this parameter.
If you don\'t use the SDK and instead generate a raw HTTP request to the
Secrets Manager service endpoint, then you must generate a
<code>ClientRequestToken</code> yourself for new versions and include that value in
the request.</p>
<p>You only need to specify your own value if you implement your own retry
logic and want to ensure that a given secret is not created twice. We
recommend that you generate a
<a href='https://wikipedia.org/wiki/Universally_unique_identifier'>UUID-type</a>
value to ensure uniqueness within the specified secret.</p>
<p>Secrets Manager uses this value to prevent the accidental creation of
duplicate versions if there are failures and retries during the
function\'s processing. This value becomes the <code>VersionId</code> of the new
version.</p></td>
    </tr>
    <tr>
      <th>RotationLambdaARN</th>
      <td><p>(Optional) Specifies the ARN of the Lambda function that can rotate the
secret.</p></td>
    </tr>
    <tr>
      <th>RotationRules</th>
      <td><p>A structure that defines the rotation configuration for this secret.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This required configuration information includes the ARN of an AWS
Lambda function and the time between scheduled rotations. The Lambda
rotation function creates a new version of the secret and creates or
updates the credentials on the protected service to match. After testing
the new credentials, the function marks the new secret with the staging
label <code>AWSCURRENT</code> so that your clients all immediately begin to use the
new version. For more information about rotating secrets and how to
configure a Lambda function to rotate the secrets for your protected
service, see <a href='https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets.html'>Rotating Secrets in AWS Secrets Manager</a>
in the <em>AWS Secrets Manager User Guide</em>.</p>
<p>Secrets Manager schedules the next rotation when the previous one
completes. Secrets Manager schedules the date by adding the rotation
interval (number of days) to the actual date of the last rotation. The
service chooses the hour within that 24-hour date window randomly. The
minute is also chosen somewhat randomly, but weighted towards the top of
the hour and influenced by a variety of factors that help distribute
load.</p>
<p>The rotation function must end with the versions of the secret in one of
two states:</p><ul>
<li><p>The <code>AWSPENDING</code> and <code>AWSCURRENT</code> staging labels are attached to the
same version of the secret, or</p></li>
<li><p>The <code>AWSPENDING</code> staging label is not attached to any version of the
secret.</p></li>
</ul>

<p>If the <code>AWSPENDING</code> staging label is present but not attached to the
same version as <code>AWSCURRENT</code> then any later invocation of <code>RotateSecret</code>
assumes that a previous rotation request is still in progress and
returns an error.</p>
<p><strong>Minimum permissions</strong></p>
<p>To run this command, you must have the following permissions:</p><ul>
<li><p>secretsmanager:RotateSecret</p></li>
<li><p>lambda:InvokeFunction (on the function specified in the secret\'s
metadata)</p></li>
</ul>

<p><strong>Related operations</strong></p><ul>
<li><p>To list the secrets in your account, use ListSecrets.</p></li>
<li><p>To get the details for a version of a secret, use DescribeSecret.</p></li>
<li><p>To create a new version of a secret, use CreateSecret.</p></li>
<li><p>To attach staging labels to or remove staging labels from a version
of a secret, use UpdateSecretVersionStage.</p></li>
</ul>

    <h2 class="hasAnchor" id="request-syntax"><a class="anchor" href="#request-syntax"></a>Request syntax</h2>

    
<pre><span class='no'>svc</span>$<span class='fu'>rotate_secret</span>(
  <span class='kw'>SecretId</span> <span class='kw'>=</span> <span class='st'>"string"</span>,
  <span class='kw'>ClientRequestToken</span> <span class='kw'>=</span> <span class='st'>"string"</span>,
  <span class='kw'>RotationLambdaARN</span> <span class='kw'>=</span> <span class='st'>"string"</span>,
  <span class='kw'>RotationRules</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
    <span class='kw'>AutomaticallyAfterDays</span> <span class='kw'>=</span> <span class='fl'>123</span>
  )
)</pre>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># The following example configures rotation for a secret by providing the</span>
<span class='co'># ARN of a Lambda rotation function (which must already exist) and the</span>
<span class='co'># number of days between rotation. The first rotation happens immediately</span>
<span class='co'># upon completion of this command. The rotation function runs</span>
<span class='co'># asynchronously in the background.</span>
<span class='no'>svc</span>$<span class='fu'>rotate_secret</span>(
  <span class='kw'>RotationLambdaARN</span> <span class='kw'>=</span> <span class='st'>"arn:aws:lambda:us-west-2:123456789012:function:MyTestDatabaseRotation..."</span>,
  <span class='kw'>RotationRules</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
    <span class='kw'>AutomaticallyAfterDays</span> <span class='kw'>=</span> <span class='fl'>30L</span>
  ),
  <span class='kw'>SecretId</span> <span class='kw'>=</span> <span class='st'>"MyTestDatabaseSecret"</span>
)

<span class='co'># The following example requests an immediate invocation of the secret's</span>
<span class='co'># Lambda rotation function. It assumes that the specified secret already</span>
<span class='co'># has rotation configured. The rotation function runs asynchronously in</span>
<span class='co'># the background.</span>
<span class='no'>svc</span>$<span class='fu'>rotate_secret</span>(
  <span class='kw'>SecretId</span> <span class='kw'>=</span> <span class='st'>"MyTestDatabaseSecret"</span>
)
}</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Kretch, Adam Banker.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


